{% schema %}
{
"name": "Topbar Header",
"tag": "section",
"class": "topbar-section",
"settings": [
{
"type": "link_list",
"id": "main_menu",
"label": "Main menu",
"default": "main-menu"
}
]
}
{% endschema %}

<style>
  #locksmith-content .section {
    height: 500px !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
  }
  #locksmith-content form{
    padding:5px !important;
    width:100% !important;
    max-width:800px !important;
    margin:auto;
      display: flex !important;
      flex-direction:column !important;
    justify-content: center !important;
    align-items: center !important;
    gap:15px;
  }
    #locksmith-content form p {
    width:100% !important;
    }
   #locksmith-content form p input{
  outline:none !important;
  border:1px black solid !important;
  width: 100% !important;
  }
  #locksmith-content form button{
  background:#2A4D4A !important;
  font-size:large !important;
  border-radius:8px !important;
  }
   #locksmith-content form p label{
  font-size:large !important;
  color:#000 !important;
  font-weight:bold !important;
  text-align:center !important;
  }
  .header-section{
    width: 100%;
    background-color: #f8f8f8;
  }
  .topbar_logo {
    max-width: 2000px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: nowrap;
    padding: 10px 50px;
    gap: 20px;
    position: relative;
  }

  .topbar_logo_sections {
    display: flex;
    align-items: center;
    gap: 15px;
    flex-shrink: 0;
  }

  .ZIP_Logo img {
    max-height: 50px;
    width: auto;
  }

  .searchSection {
    flex: 1;
    max-width: 800px;
    height: 40px;
    display: flex;
    align-items: center;
    background: white;
    border: 2px solid #ccc;
    border-radius: 5px;
    overflow: hidden;
  }

  .searchSection input[type="search"] {
    flex: 1;
    padding: 8px 12px;
    border: none;
    outline: none;
    font-size: 14px;
  }

  .ClickToSearch {
    background: #2A4D4A;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px 12px;
    cursor: pointer;
    border: none;
  }

  .ClickToSearch svg {
    width: 20px;
    height: 20px;
    fill: #fff;
  }

  .topbar_logo_sections a {
    display: flex;
    align-items: center;
    gap: 6px;
    text-decoration: none;
    color: #333;
    font-size: 14px;
    white-space: nowrap;
  }

  .icons img {
    width: 18px;
    height: 18px;
  }

  #myaccount,
  #mycart {
    cursor: pointer;
    position: relative;
    background: none;
    border: none;
  }

  #myaccount svg,
  #mycart svg {
    width: 30px;
    height: 30px;
    fill: #333;
    margin-right: 5px;
    padding: 5px;
    background: white;
    border-radius: 50%;
    border: 1px #ccc solid;
  }

  .account_cart {
    display: flex;
    align-items: center;
    gap: 15px;
    flex-shrink: 0;
    position: relative;
  }

  #account_popup {
    position: absolute;
    top: 40px;
    right: 60px;
    background: white;
    border: 1px solid #ccc;
    padding: 15px;
    width: 180px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    display: none;
    flex-direction: column;
    z-index: 999;
    border-radius: 8px;
  }
  #account_popup a {
    display: block;
    text-align: center;
    background: #2A4D4A;
    color: white;
    padding: 8px;
    margin: 5px 0;
    border-radius: 4px;
    text-decoration: none;
    font-size: 14px;
  }

  #account_popup p {
    font-size: 13px;
    text-align: center;
    margin: 5px 0;
    color: #555;
  }

  .PhoneSearch {
    display: none;
    padding: 10px 20px;
    background: #f8f8f8;
  }

  /* Burger Icon */
  .burger-icon {
    display: none;
    background: none;
    border: none;
    cursor: pointer;
  }

  .burger-icon svg {
    width: 28px;
    height: 28px;
  }

  @media (max-width: 1199px) {
    .burger-icon {
      display: block;
    }
  }

  @media (max-width: 1199px) {
    .topbar_logo {
      padding: 10px 20px;
    }

    .contact_Dtls_logo {
      display: none;
    }
  }

  @media (max-width: 767px) {
    .topbar_logo {
      padding: 10px 10px;
    }

    .DesktopSearch {
      display: none;
    }

    .PhoneSearch {
      display: flex;
    }

    .searchSection {
      max-width: 100%;
    }

    #account_popup {
      right: 0;
      left: auto;
        top: 45px;
    }
  }
  .menu-item-best-seller > a {
  border: 1px dotted #2a4d4a;
  border-radius: 4px;
}
</style>
<div class="header-section">
<div class="topbar_logo">
  <!-- Burger Menu (Mobile Only) -->
  <button id="burgerMenu" class="burger-icon" aria-label="Toggle Menu">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#2a2a2a" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round">
      <path id="burgerPath" d="M3 6h18M3 12h18M3 18h18"></path>
    </svg>
  </button>


  <!-- Logo -->
  <div class="topbar_logo_sections ZIP_Logo">
    <a href="/"><img
        src="https://cdn.shopify.com/s/files/1/0614/7453/7714/files/ZIPCushions_e9250693-aa84-4f72-be49-8c51b514c6b5.png?v=1746337500"
        alt="ZIPCushions Logo"></a>
  </div>

  <!-- Search (Desktop Only) -->
  <div class="searchSection DesktopSearch" role="search">

  
    <input type="search" placeholder="Search products..." aria-label="Search products">
    
    <button class="ClickToSearch" aria-label="Search button">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M21.71 20.29l-3.388-3.388A8.932 8.932 0 0019 11a9 9 0 10-9 9 8.932 8.932 0 005.902-1.678l3.388 3.388a1 1 0 001.414-1.414zM4 11a7 7 0 1114 0 7 7 0 01-14 0z" />
      </svg>
    </button>
  </div>

  <!-- Contact Info (Desktop Only) -->
  <div class="topbar_logo_sections contact_Dtls_logo">
    <a href="mailto:sales@zipcushions.com">
      <span class="icons"><img src="https://cdn.shopify.com/s/files/1/0614/7453/7714/files/sms.png?v=1744104998"
          alt="Email Icon"></span>
      <span>sales@zipcushions.com</span>
    </a>
    <a href="tel:7206277225">
      <span class="icons"><img src="https://cdn.shopify.com/s/files/1/0614/7453/7714/files/call.png?v=1744104998"
          alt="Phone Icon"></span>
      <span>720-627-7225</span>
    </a>
  </div>

  <!-- Account + Cart -->
  <div class="topbar_logo_sections account_cart">
    <button id="myaccount" title="My Account" aria-haspopup="true" aria-expanded="false">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z" />
      </svg>
    </button>
    
    <div id="account_popup" role="dialog" aria-label="Account options">
{% if customer %}
      <p><strong>Welcome!</strong></p>
      <p><strong>{{ customer.first_name }}</strong></p>
      <a href="{{ routes.account_url }}">Orders</a>
      <a href="/account/logout?return_url=/account/login">Logout</a>
{% else %}
      <p><strong>Welcome!</strong></p>
      <a href="/account/login">Login</a>
      <p>Don’t have an account?</p>
      <a href="/account/register">Register</a>
{% endif %}
    </div>

    <button id="mycart" title="My Cart">
      <a href="/cart">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zM7.16 14l.84-2h7.45c.75 0 1.41-.41 1.75-1.03L21 4H6.42l-.94-2H1v2h3l3.6 7.59-1.35 2.45C5.16 15.37 6.27 17 7.75 17H19v-2H7.42c-.14 0-.25-.11-.26-.25z" />
        </svg>
      </a>
    </button>
  </div>
</div>
</div>
<!-- Mobile Search -->
<div class="topbar_logo PhoneSearch">
  <div class="searchSection" role="search">
    <input type="search" placeholder="Search products..." aria-label="Search products">
    <button class="ClickToSearch" aria-label="Search button">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M21.71 20.29l-3.388-3.388A8.932 8.932 0 0019 11a9 9 0 10-9 9 8.932 8.932 0 005.902-1.678l3.388 3.388a1 1 0 001.414-1.414zM4 11a7 7 0 1114 0 7 7 0 01-14 0z" />
      </svg>
    </button>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const menuLinks = document.querySelectorAll('.main_menu_items .menu-item > a');
    menuLinks.forEach(link => {
      if (link.textContent.toLowerCase().includes('best seller')) {
        link.parentElement.classList.add('menu-item-best-seller');
      }
    });

  });
</script>

          
<script>

  // Account Popup
  const accountBtn = document.getElementById('myaccount');
  const accountPopup = document.getElementById('account_popup');

  accountBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    const expanded = accountPopup.style.display === 'flex';
    accountPopup.style.display = expanded ? 'none' : 'flex';
    accountBtn.setAttribute('aria-expanded', !expanded);
  });

  // Close popups when clicking outside
  document.addEventListener('click', (e) => {
    if (!accountPopup.contains(e.target) && !accountBtn.contains(e.target)) {
      accountPopup.style.display = 'none';
      accountBtn.setAttribute('aria-expanded', 'false');
    }
  });



  // Shopify Search Integration
  document.querySelectorAll('.ClickToSearch').forEach(button => {
    button.addEventListener('click', () => {
      const input = button.previousElementSibling;
      const searchTerm = input.value.trim();
      if (searchTerm) {
        window.location.href = `/search?q=${encodeURIComponent(searchTerm)}`;
      }
    });
  });

  // Shopify Cart Count
  fetch('/cart.js')
    .then(res => res.json())
    .then(cart => {
      const count = cart.item_count;
      const cartButton = document.getElementById('mycart');
      if (count > 0) {
        const badge = document.createElement('span');
        badge.textContent = count;
        badge.style.position = 'absolute';
        badge.style.top = '0';
        badge.style.right = '0';
        badge.style.background = '#2A4D4A';
        badge.style.color = 'white';
        badge.style.fontSize = '12px';
        badge.style.padding = '2px 6px';
        badge.style.borderRadius = '50%';
        cartButton.appendChild(badge);
      }
    });


</script>



<style>
  /* ===== Desktop & General Styles ===== */
  .main-menu {
    width: 100%;
    background: #ffffff;
    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
    padding: 10px;
    display: flex;
    justify-content: center;
  }

  .main_menu_items ul {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    gap: 25px;
  }

  .menu-item {
    position: relative;
    display: flex;
    align-items: center;
  }

  .menu-item>a {
    text-decoration: none;
    color: #2a2a2a;
    font-size: 15px;
    font-weight: 500;
    padding: 8px 12px;
    display: inline-block;
    transition: color 0.3s ease;
  }

  .menu-item>a:hover {
    color: #2A4D4A;
  }

  .main_menu_items ul li ul {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 220px;
    background: #fff;
    border: 1px solid #ddd;
    padding: 10px 0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    z-index: 1000;
  }

  .main_menu_items ul li ul .submenu2 {
    top: 0 !important;
    left: 90% !important;
    background: #ddd !important;
    min-height: 100% !important;
  }

  /* Hover show on desktop */
  @media (min-width: 1199px) {

    .menu-item:hover>.submenu1,
    .submenu-item:hover>.submenu2 {
      display: block;
    }

    .submenu1,
    .submenu2 {
      display: none;
      position: relative;
      top: 0;
      left: 0;
      margin-left: 0;
      background: #fff;
      border: none;
      box-shadow: none;
      padding-left: 15px;
    }

    .submenu2 {
      border-left: 2px solid #ddd;
      margin-left: 10px;
      padding-left: 10px;
    }

    .submenu1 a,
    .submenu2 a {
      display: block;
      padding: 8px 16px;
      text-decoration: none;
      color: #333;
      font-size: 14px;
      transition: background 0.3s ease;
    }

    .submenu-toggle {
      display: none;
    }

    /* Rotate arrow on hover (desktop) */
    .menu-item:hover>.submenu-toggle .arrow,
    .submenu-item:hover>.submenu-toggle .arrow {
      transform: rotate(180deg);
    }
  }

  .submenu1 a,
  .submenu2 a {
    display: block;
    padding: 10px 16px;
    text-decoration: none;
    color: #333;
    font-size: 14px;
    transition: background 0.3s ease;
  }

  .main_menu_items ul li ul a:hover,
  .main_menu_items ul li ul li ul a:hover {
    background-color: #f0f0f0;
    color: #2A4D4A;
  }
  .mobile-icons img {
    width: 10px;
    height: 10px;
  }
  .Mobile-Header-offer{
    display: none;
  }
  .mobile_contact{
    display: none;
  }
  .menu-item > a.active {
  color: #2A4D4A;
  border-bottom: 2px solid #2A4D4A;
}

  /* ===== Mobile styles ===== */
    @media (max-width: 1199px) {
      .main-menu {
        display: none;
        flex-direction: column;
        align-items: stretch;
        padding: 15px 10px;
        background: #fff;
        max-width: 350px;
        height:100%;
        justify-content: flex-start;
        top: 40;
        position: fixed;
        z-index: 9999999;
        padding-top: 10px;
      }

      .Mobile-Header-offer{
        display: flex;
        flex-direction:column;
        text-align:center;
        padding: 5px 0px;
        font-weight: bold;
        padding-top:20px;
        color:#000;
        margin:12px;
      }
      .mobile_contact{
        width: 260;
        display: flex;
        justify-content: space-between;
        text-align: center;
        padding: 5px 0px;
        padding-top:50px;
        /* position: absolute;
        bottom: 50; */
        align-items: center;
  }
   .mobile_contact .mobile_dtls{
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  font-size: 15px;
  font-weight: bold;
  }
  .mobile_contact .mobile_dtls a{
    cursor: pointer;
    text-decoration: none;
    color: black;
  }
 
      .main_menu_items ul {
        flex-direction: column;
        gap: 0;
        width: 100%;
      }

      .menu-item,
      .submenu-item {
        display: flex;
        flex-direction: row;
        border-bottom: 1px solid #eee;
        justify-content: space-between;
        position: relative;
      }
     .main_menu_items ul li ul .submenu2 {
     top: 100% !important;
    left: 0 !important;
    background: #ddd !important;
    min-height: 100% !important;
     }
      .menu-item>a,
      .submenu-item>a {
        padding: 12px;
        font-size: 13px;
        font-weight: 500;
        color: #2a2a2a;
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
      }

      .submenu-toggle {
        background: none;
        border: none;
        font-size: 18px;
        cursor: pointer;
        padding: 0 12px;
        color: #2a2a2a;
        width: 180px;
        text-align: right;
      }

      .submenu-toggle .arrow::before {
        content: '+';
        display: inline-block;
        transition: transform 0.3s ease;
      }

      .submenu-toggle.active .arrow::before {
        content: '-';
      }

      .submenu1,
      .submenu2 {
        display: none;
        flex-direction: column;
        padding-left: 20px;
        background: #f9f9f9;
      }

      .submenu1.show,
      .submenu2.show {
        display: flex;
      }

      .submenu1 a,
      .submenu2 a {
        padding: 10px 15px;
        font-size: 14px;
        color: #444;
        text-decoration: none;
      }

      .submenu2 {
        padding-left: 30px;
        background: #f0f0f0;
      }
      #burgerMenu_ontop{
        background: white;
        border-radius: 1px black solid;
        border-radius: 50%;
        position: absolute;
        right: 10;
        top: 10;
      }
    }

@media (min-width:1200px) and (max-width: 1415px){
.menu-item>a {
font-size: 13px;
font-weight: 300;
padding: 8px;
}

.main_menu_items ul{
gap: 8px;
}
}
</style>

<div class="main-menu">
     <!-- Burger Menu (Mobile Only) -->
     <div><button id="burgerMenu_ontop" class="burger-icon">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#2a2a2a" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round">
        <path id="burgerPath_mobile" d="M6 6L18 18M6 18L18 6"></path>
      </svg>
    </button>
  </div>

 <div class="Mobile-Header-offer">
 Free Shipping  ⛟
    </div>

  <div class="main_menu_items">
    <ul>
      {% for link in linklists[section.settings.main_menu].links %}
      <li class="menu-item{% if link.links != blank %} has-submenu{% endif %}">
        <a href="{{ link.url }}">{{ link.title }}</a>
        {% if link.links != blank %}
        <button class="submenu-toggle" aria-label="Toggle submenu">
          <span class="arrow"></span>
        </button>
        <ul class="submenu1">
          {% for sublink in link.links %}
          <li class="submenu-item{% if sublink.links != blank %} has-submenu{% endif %}">
            <a href="{{ sublink.url }}">{{ sublink.title }}</a>
            {% if sublink.links != blank %}
            <button class="submenu-toggle" aria-label="Toggle submenu">
              <span class="arrow"></span>
            </button>
            <ul class="submenu2">
              {% for sub_sublink in sublink.links %}
              <li><a href="{{ sub_sublink.url }}">{{ sub_sublink.title }}</a></li>
              {% endfor %}
            </ul>
            {% endif %}
          </li>
          {% endfor %}
        </ul>
        {% endif %}
      </li>
      {% endfor %}
    </ul>
  </div>

<div class="mobile_contact">
  <div>Contact Us:</div>
  <div class="mobile_dtls">
    <a href="tel:(720) 627-7225">(720) 627-7225</a>
  </div>
</div>

</div>

<script>
  const burgerMenu = document.getElementById('burgerMenu');
  const mobileMenu = document.querySelector('.main-menu');
  const burgerPath = document.getElementById('burgerPath');     
  const burgerMenu_Mobile = document.getElementById('burgerMenu_ontop');
  let isOpen = false;

  burgerMenu_Mobile.addEventListener('click', (e) => {
    mobileMenu.style.display = "none";
  });
  burgerMenu.addEventListener('click', (e) => {
    mobileMenu.style.display = "flex";
    burgerPath?.setAttribute(
      'd',
      isOpen ? 'M3 6h18M3 12h18M3 18h18' : 'M3 6h18M3 12h18M3 18h18'
    );
  });

  document.querySelectorAll('.submenu-toggle').forEach((btn) => {
    btn.addEventListener('click', function (e) {
      e.preventDefault();
      e.stopPropagation();

      const submenu = this.nextElementSibling;

      // Find all sibling submenu toggles (same nesting level only)
      const parentLi = this.closest('li');
      const siblingSubmenus = parentLi.parentElement.querySelectorAll(':scope > li > .submenu1, :scope > li > .submenu2');
      const siblingToggles = parentLi.parentElement.querySelectorAll(':scope > li > .submenu-toggle');

      // Close only sibling submenus at the same level
      siblingSubmenus.forEach(s => {
        if (s !== submenu) s.classList.remove('show');
      });

      siblingToggles.forEach(t => {
        if (t !== this) t.classList.remove('active');
      });

      // Toggle current submenu
      submenu.classList.toggle('show');
      this.classList.toggle('active');
    });
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const links = document.querySelectorAll('.main_menu_items .menu-item > a');
    const currentUrl = window.location.pathname;

    links.forEach(link => {
      const linkPath = new URL(link.href).pathname;
      if (currentUrl === linkPath || (linkPath !== "/" && currentUrl.startsWith(linkPath))) {
        link.classList.add('active');
      }
    });
  });
</script>

<script>
  // Handle pressing Enter on search inputs
  document.querySelectorAll('.searchSection input[type="search"]').forEach(input => {
    input.addEventListener('keydown', function (e) {
      if (e.key === 'Enter') {
        e.preventDefault(); // prevent form submission if inside a form
        const searchTerm = this.value.trim();
        if (searchTerm) {
          window.location.href = `/search?q=${encodeURIComponent(searchTerm)}`;
        }
      }
    });
  });
</script>
