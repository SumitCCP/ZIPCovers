{% comment %}
** Registration template - main content area **
{% endcomment %}

{% assign id = section.id %}
{% comment %}Layout{% endcomment %}
{% assign width = section.settings.width %}
{% assign padding_top = section.settings.padding_top %}
{% assign padding_bottom = section.settings.padding_bottom %}
{% comment %}Advanced{% endcomment %}
{% assign css_class = section.settings.css_class %}
{% assign custom_css = section.settings.custom_css %}

{% style %}

  .section__wrapper {
    padding-top: {{ padding_top }}px;
    padding-bottom: {{ padding_bottom }}px;
  }

  {% render 'css-loop',
          css: custom_css,
          id: id
  %}
{% endstyle %}

<section class="section section__wrapper is-width-{{ width }} {{ css_class }}">
  <header class="container">
    {%- capture title -%}{{ 'customer.register.title' | t }}{%- endcapture -%}
    {% render 'heading',
            title: title,
            heading_tag: 'h1',
            context: 'register',
            text_alignment: 'left'
    %}
  </header>

  <div class="container">
    <div class="register one-half medium-down--one-whole column has-padding-bottom">
      <div id="customer" class="register__form">

        <!-- Create Customer -->
        <div id="create-customer">

          {% if section.settings.richtext != blank %}
            <div class="login__text has-padding-bottom">
              {{ section.settings.richtext }}
            </div>
          {% endif %}

          {% form 'create_customer' %}

            {% comment %} {{ form.errors | default_errors }} {% endcomment %}
<style>
  .formErrors {
    position: fixed;
    background: rgba(0,0,0,0.5);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    width: 100vw;
    top: 0;
    left: 0;
  }

  .formErrors__card {
    position: relative;
    background: #fff;
    color: #111;
    width: 90%;
    max-width: 600px;
    width: calc(100% - 40px);
    border-radius: 8px;
    padding: 20px 24px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.2);
  }

  .formErrors__title {
    margin: 0 0 8px 0;
    font-weight: 700;
    font-size: 18px;
  }

  .formErrors ul {
    margin: 0;
    padding-left: 18px; /* keep list semantics */
  }

  .formErrors li {
    margin: 8px 0;
  }
 .formErrors li a {
    color: #0066cc;
    text-decoration: none;
    font-weight: bold;
  }
  .formErrors__actions {
    margin-top: 16px;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .formErrors__close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 22px;
    line-height: 1;
    cursor: pointer;
    color: #555;
  }

  .formErrors__close:hover {
    color: #000;
  }
</style>

{% if form.errors %}

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var formSection = document.querySelector(".formSection");
      if (formSection) formSection.style.display = "none";

      document.documentElement.style.overflow = "hidden";

      var overlay = document.getElementById("formErrors");
      if (overlay) overlay.focus();

      // Restore form + remove overlay on close
      document.addEventListener("click", function(e){
        if (e.target.matches("#formErrorsTryAgain, #formErrorsClose")) {
          if (formSection) formSection.style.display = "";
          var ov = document.getElementById("formErrors");
          if (ov) ov.remove();
          document.documentElement.style.overflow = "";
        }
      });
    });
  </script>

<div id="formErrors" class="formErrors" role="alert" aria-live="assertive" tabindex="-1">
  <div class="formErrors__card" role="document">
    <button id="formErrorsClose" class="formErrors__close" type="button" aria-label="Close">&times;</button>

    {% if form.posted_successfully? %}
      <h3 class="formErrors__title">Check your email</h3>
      <p>We have sent an email to the address you provided. Please click the link inside to continue.</p>
    {% else%}
      <ul>
        {% for field in form.errors %}
          {% assign msg = form.errors.messages[field] %}

          {% if msg contains 'already associated with an account' %}
            <li>
              This email address is already associated with an account.
              If this account is yours, you can
              <a href="{{ routes.account_login_url }}">Login</a> or
              <a href="{{ routes.account_login_url }}#">reset your password</a>.
            </li>
          {% else %}
            <li>{{ msg }}
            <a class="btn" href="{{ routes.account_register_url }}">Try again</a>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    {% endif %}
  </div>
</div>
{% endif %}




                      <div id="user_name" class="field">
              <div class="control">
                <input required type="text" value="" name="customer[Username]" id="user_name" class="input" size="30" placeholder="Username" />
              </div>
            </div>

<div class="register-block">
            <div id="first_name" class="field">
              <label class="label" for="{{ label | replace: ' ', '_' }}">{{ 'customer.register.first_name' | t }}</label>
              <div class="control">
                <input required type="text" value="" name="customer[first_name]" id="first_name" class="input" size="30" placeholder="{{ 'customer.register.first_name' | t }}" />
              </div>
            </div>

            <div id="last_name" class="field">
              <label class="label" for="{{ label | replace: ' ', '_' }}">{{ 'customer.register.last_name' | t }}</label>
              <div class="control">
                <input required type="text" value="" name="customer[last_name]" id="last_name" class="input" size="30" placeholder="{{ 'customer.register.last_name' | t }}" />
              </div>
            </div>
          </div>
          
            <div id="email" class="field">
              <label class="label" for="{{ label | replace: ' ', '_' }}">{{ 'customer.register.email' | t }}*</label>
              <div class="control">
                <input required type="email" value="" name="customer[email]" id="email" class="input" size="30" placeholder="{{ 'customer.register.email' | t }}" />
              </div>
            </div>
<div class="register-block2">
            <div id="password" class="field">
              <label class="label" for="{{ label | replace: ' ', '_' }}">{{ 'customer.register.password' | t }}*</label>
              <div class="control">
                <input required type="password" value="" name="customer[password]" id="password" class="input" size="30" placeholder="{{ 'customer.register.password' | t }}" />
              </div>
            </div>
  <div class="control">
      <input required type="password" value="" name="customer[password_confirmation]" id="password_confirm" class="input" size="30" placeholder="Confirm Password"/>

          </div>
          </div>
          <div class="reg-txt"><p>Your personal data will be used to support your experience throughout this website, to manage access to your account, and for other purposes described in our <a href="#">privacy policy.</a></p>
           <div class="r-check"><input required type="checkbox" name="customer[checkupdates]"><span> I want to receive updates about products and promotions.
</span></div>

            <div class="is-flex is-justify-space-between">
              <button class="button button--secondary" type="submit" value="{{ 'customer.register.sign_up' | t }}">Register</button>
            </div>

            <p class="has-padding-top login-title">
              {{ 'customer.register.returning_customer_label' | t }} <a href="{{ routes.account_login_url }}" class="hoverButton">{{ 'customer.register.sign_in_html' | t }}</a>
            </p>
          {% endform %}
        </div><!-- /#create-customer -->
      </div>
    </div>

    <div class="register__image one-half medium-down--one-whole column is-order-aligned-{{ section.settings.image_position }}">
      {% if section.settings.image %}
        {% render 'image-element',
                image: section.settings.image,
                alt: section.settings.image.alt
        %}
      {% endif %}
    </div>
  </div>
</section>

{% schema %}
  {
    "name": "Register",
    "class": "register-section",
    "settings": [
      {
        "type": "richtext",
        "id": "richtext",
        "label": "Text"
      },
      {
        "type": "image_picker",
        "id": "image",
        "label": "Image"
      },
      {
        "type": "select",
        "id": "image_position",
        "label": "Image position",
        "options": [
          {
            "value": "left",
            "label": "Left"
          },
          {
            "value": "right",
            "label": "Right"
          }
        ],
        "default": "right"
      },
      {
        "type": "header",
        "content": "Layout"
      },
      {
        "type": "select",
        "id": "width",
        "label": "Width",
        "default": "standard",
        "options": [
          {
            "value": "standard",
            "label": "Standard"
          },
          {
            "value": "wide",
            "label": "Wide"
          }
        ]
      },
      {
        "type": "range",
        "id": "padding_top",
        "label": "Top spacing",
        "min": 0,
        "max": 80,
        "default": 40,
        "unit": "px"
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "label": "Bottom spacing",
        "min": 0,
        "max": 80,
        "default": 40,
        "unit": "px"
      },
      {
        "type": "header",
        "content": "Advanced"
      },
      {
        "type": "paragraph",
        "content": "[Learn more](https://help.outofthesandbox.com/hc/en-us/articles/360022329373)"
      },
      {
        "type": "text",
        "id": "css_class",
        "label": "CSS Class"
      },
      {
        "type": "textarea",
        "id": "custom_css",
        "label": "Custom CSS"
      }
    ]
  }
{% endschema %}
