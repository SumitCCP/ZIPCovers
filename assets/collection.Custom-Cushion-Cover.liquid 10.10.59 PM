{% assign product_types = "Rectangle,Square,Round,Half-Round,Curved,Trapezium,Bolster,L Shape,Sofa,Chair,Bench" | split: "," %}

<!-- Collection Banner -->
<div class="collection-banner">
  {% if collection.image %}
  <img src="{{ collection.image | img_url: '1920x600' }}" alt="{{ collection.title }}">
  {% endif %}
</div>
<div class="collection-banner-mobile">
  <img src="https://cdn.shopify.com/s/files/1/0614/7453/7714/files/Custom_Cover_app_Banner.png?v=1757594373" alt="{{ collection.title }}">
</div>
{% section 'Collection-Review' %}

<div id="collections-container">
      <div class="blackfridaysale"><img src="https://cdn.shopify.com/s/files/1/0614/7453/7714/files/collection-black-friday-deal.png?v=1763396656" alt="Black Friday Sale"></div>
  <style>
.blackfridaysale{
  width:100%;
  max-width:1200px;
  margin:auto;
  border-radius:20px 20px 0 0;
  margin-bottom:40px;
  padding:0 5px;
}
.blackfridaysale img{
  border-radius:20px 20px 0 0;
  width:100%;
}
@media (max-width:500px){
.blackfridaysale{
  border-radius:5px 5px 0 0;
  margin-bottom:20px;
}
.blackfridaysale img{
  border-radius:5px 5px 0 0;
}
}
    </style>

  <div class="collection-wrapper" data-collection="{{ collection.handle }}">
    <h1>{{ collection.title }}</h1>
<!-- Filter Options -->
<div class="filters">
    <button type="button" class="blog-scroll-btn blog-scroll-btn--prev" aria-label="Scroll left">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="15 18 9 12 15 6"></polyline>
    </svg>
  </button>

  <div class="shape-filter" role="tablist" aria-label="Filter by shape">
    <button type="button" class="shape-btn is-active" data-value="all">Show All</button>
    {% for type in product_types %}
      <button type="button" class="shape-btn" data-value="{{ type | downcase }}">{{ type }}</button>
    {% endfor %}
  </div>

    <button type="button" class="blog-scroll-btn blog-scroll-btn--next" aria-label="Scroll right">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </button>

</div>
    <!-- Pagination: Show 40 products per page -->
    {% paginate collection.products by 40 %}
    <div class="collection-grid">
      {% for product in collection.products %}
      <div class="product-item" data-title="{{ product.title | downcase }}">
        <a href="{{ product.url }}">
          <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
    
          {% if forloop.first %}
            <div class="bestseller-badge">Best Seller</div>
          {% endif %}
        
      {% if product.published_at %}
  {% assign publish_date = product.published_at | date: '%s' | times: 1 %}
  {% assign current_date = 'now' | date: '%s' | times: 1 %}
  {% assign seconds_since_publish = current_date | minus: publish_date %}
  {% assign seven_days_in_seconds = 7 | times: 86400 %}
  
  {% if seconds_since_publish <= seven_days_in_seconds %}
    <!-- <div class="bestseller-badge">New Launch</div> -->
  {% endif %}
{% endif %}
    
          <p class="product-title">{{ product.title }}</p>
          <p class="product-price">{{ product.price | money }}</p>
        </a>
        <a href="{{ product.url }}" class="view-product-btn">Customize Now</a>
      </div>
    {% endfor %}
    
    </div>

    <!-- Pagination Links -->
    <div class="pagination">
      {% if paginate.previous %}
      <a href="{{ paginate.previous.url }}" class="page-link prev">Previous</a>
      {% endif %}

      {% for part in paginate.parts %}
      {% if part.is_link %}
      <a href="{{ part.url }}" class="page-link">{{ part.title }}</a>
      {% else %}
      <span class="current-page">{{ part.title }}</span>
      {% endif %}
      {% endfor %}

      {% if paginate.next %}
      <a href="{{ paginate.next.url }}" class="page-link next">Next</a>
      {% endif %}
    </div>
    {% endpaginate %}
  </div>
</div>

<div class="skcontainer">
  <div class="calltoaction">
    <p>We do provide a lot of other custom shapes as well! Drop us a Chat and we'll assist you with almost any other
      shape! (Blue Icon - bottom right corner)</p>
  </div>
</div>
<!-- Collection Description -->
{% if collection.description != blank %}
<div class="collection-description">
  {{ collection.description }}
</div>
{% endif %}
{% section 'Order-Steps' %}
{% section 'collection-faq-dynamic' %}

{% style %}
  #section-{{ section.id }}.reviewContainer{
  padding-top:20px !important;
  }
.bestseller-badge {
  position: absolute;
  top: 10px;
  left: 10px;
  background: #E63946;
  color: white;
  padding: 5px 10px;
  border-radius: 5px;
  font-weight: bold;
  font-size: 14px;
  z-index: 3;
}
.product-item {
  position: relative; /* Add this to ensure badge is positioned correctly */
}

/* Pagination Styles */
.pagination {
display: flex;
justify-content: center;
align-items: center;
margin-top: 40px;
}
.page-link, .current-page {
padding: 10px 15px;
margin: 0 5px;
text-decoration: none;
border: 2px solid #2A4D4A;
border-radius: 5px;
color: #2A4D4A;
font-weight: bold;
background: white;
transition: all 0.3s;
}
.page-link:hover {
background: #2A4D4A;
color: white;
}
.current-page {
background: #2A4D4A;
color: white;
}
.prev, .next {
font-weight: bold;
}

.skcontainer {
width: 100%;
margin: 30px 0px;
}
.calltoaction {
max-width: 1000px;
margin: auto;
background: #F1F1F1;
padding: 50px;
border-radius: 10px;
text-align: center;
}
.calltoaction p{
font-size: x-large!important;
}
@media only screen and (max-width: 600px) {
.calltoaction {
max-width: 350px;
padding: 20px;
}
.calltoaction p{
font-size: large!important;
}
}

h1 {
text-align: left;
font-weight: bold;
margin-top: 150px;
font-size: xx-large;
max-width: 1200px;
margin:auto;
}

/* Collection Banner */
.collection-banner {
width: 100%;
margin-bottom: 50px;
position:relative;
}

.collection-banner img {
width: 100%;
height: auto;
object-fit: cover;
}
.collection-banner-mobile {
display:none;
width: 100%;
margin-bottom: 10px;
position:relative;
}

.collection-banner-mobile img {
width: 100%;
height: auto;
object-fit: cover;
}

h2 {
max-width: 1200px;
margin: auto;
font-weight: bold;
font-size: x-large;
}

@media only screen and (max-width: 600px) {
h2 {
font-size: large;
width: 98%;
}
h1{
  font-size: x-large;width: 98%;
}
}

.collection-grid {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: 20px;
justify-content: center;
margin: auto;
max-width: 1200px;
border-top: 2px #ccc solid;
padding-top: 30px;
}
@media (max-width: 768px) {
.collection-grid {
grid-template-columns: repeat(2, 1fr);
width: 95%;
}
}

/* Collection Description */
.collection-description {
max-width: 1200px;
margin: 50px auto;
padding: 20px;
}
.collection-description p{
  text-align:justify;
}
.collection-description h3{
font-size: large;
}

[data-layouthub="section"], [data-layouthub="section"] *{
margin-left:0!important;
color: #000!important;
}
@media (max-width: 600px) {
.collection-description {
max-width: 98%;
font-size: 16px;
padding: 5px;
}
}

.product-item {
border: 1px solid #ddd;
padding: 15px;
border-radius: 8px;
background: #fff;
text-align: center;
display: flex;
flex-direction: column;
justify-content: space-between;
}
.product-item:hover {
border: 1px solid #2A4D4A;
}
.product-item img {
width: 100%;
height: 220px;
border-radius: 5px;
}
.product-title {
font-size: 16px;
margin-top: 10px;
color: #000;
}
.product-price {
font-size: 18px;
color: #000;
font-weight: bold;
}
.view-product-btn {
display: inline-block;
background: #2A4D4A;
border: 2px #2A4D4A solid;
color: white;
padding: 10px 15px;
font-size: 14px;
font-weight: bold;
border-radius: 5px;
text-decoration: none;
margin-top: 10px;
transition: background 0.3s;
}
.view-product-btn:hover {
background-color: #fff;
color: #2A4D4A;
}
@media (max-width: 600px){
.view-product-btn{
font-size: 12px;
}
.product-title {
font-size: 12px;

}
.collection-banner {
  display:none;
}
.collection-banner-mobile {
  display:block;
  width: 100%;
  margin-bottom: 10px;
  position:relative;
}
.product-item img {

height: 160px;
}

}

.calltoaction p {
font-weight: bold;
padding-bottom: 20px;
color: black;
}


/* Shape filter buttons */
/* Scroll Buttons */
  .filters .blog-scroll-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 5;
    width: 30px;
    height: 30px;
    border-radius: 999px;
    border: 1px solid #e0e0e0;
    background: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.15s ease, box-shadow 0.15s ease, opacity 0.2s ease;
  }

  .filters .blog-scroll-btn--next {
    right: 1px;
  }

  .filters .blog-scroll-btn--prev {
    left: 1px;
  }

.filters{
  max-width:1220px;
  margin:auto;
  padding:30px;
  position:relative;
}
.shape-filter{
  width:100%;
  display:flex;
  flex-shrink:1;
  gap:15px;
  justify-content:start;
  align-items:center;
    flex-wrap: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x mandatory;
    white-space:nowrap;
     scrollbar-width: none;
}
.shape-filter::-webkit-scrollbar {
    display: none;
  }
.filters .shape-btn{
  background:#fff;
  min-width:120px;
  padding:8px 14px;
  border-radius:8px;
  font-size:14px;
  cursor:pointer;
  transition:all .2s ease;
  border:1px #ccc solid ;
  outline:none;
}

.filters .shape-btn:hover{ background:#ccc; }
.filters .shape-btn.is-active{ background:#ccc; }

@media (max-width:600px){
  .shape-btn{ padding:7px 12px; font-size:13px; }
}
{% endstyle %}


<script>
document.addEventListener('DOMContentLoaded', function () {
  const buttons  = document.querySelectorAll('.shape-btn');
  const wrappers = document.querySelectorAll('.collection-wrapper');

  // Normalize strings: lowercase & remove spaces/punctuation so “semi-round” == “semiround”
  const norm = s => (s || '').toLowerCase().replace(/[^a-z0-9]/g, '');

  function filterProducts(selectedRaw) {
    const selected = norm(selectedRaw || 'all');

    wrappers.forEach(wrapper => {
      let hasVisible = false;

      wrapper.querySelectorAll('.product-item').forEach(card => {
        const titleNorm = norm(card.dataset.title);
        const show = selected === 'all' || titleNorm.includes(selected);

        card.style.display = show ? 'flex' : 'none';
        if (show) hasVisible = true;
      });

      wrapper.style.display = hasVisible ? '' : 'none';
    });
  }

  // Click to filter + set active state
  buttons.forEach(btn => {
    btn.addEventListener('click', () => {
      buttons.forEach(b => b.classList.toggle('is-active', b === btn));
      filterProducts(btn.dataset.value);
    });
  });

  // Apply default "All" on load
  filterProducts('all');
});

let shapeFilter = document.querySelector(".shape-filter");

let next = document.querySelector(".filters .blog-scroll-btn--next")?.addEventListener("click",(e)=>{
  e.preventDefault();
  shapeFilter.scrollBy({ left: 200, behavior: "smooth" });
});

let prev = document.querySelector(".filters .blog-scroll-btn--prev")?.addEventListener("click",(e)=>{
  e.preventDefault();
  shapeFilter.scrollBy({ left: -200, behavior: "smooth" });
});

</script>